/* Part 1 - finding hackers with atleast one submission daily */
select hacker_id, count(1) from (select Distinct hacker_id, submission_date from submissions) s1 group by hacker_id having count(1) = (select count(distinct(submission_date)) count_dates from submissions);

/* */
with hack as (select hacker_id, count(1) from (select Distinct hacker_id, submission_date from submissions) s1 group by hacker_id having count(1) = (select count(distinct(submission_date)) count_dates from submissions)) Select h.hacker_id from hackers h join hack hk on h.hacker_id= hk.hacker_id;



with hack as (select hacker_id, count(1) from (select Distinct hacker_id, submission_date from submissions)s1 group by hacker_id having count(1) = (select count(distinct(submission_date)) count_dates from submissions))  Select submission_date,cnt, hacker_id,name  from (Select submission_date, hacker_id, cnt,name, row_number() over (partition by submission_date order by cnt desc, hacker_id asc) rn from (Select h.name,s.submission_date,s.hacker_id, count(s.submission_id) over(partition by s.submission_date,s.hacker_id) cnt from hackers h join hack hk on h.hacker_id= hk.hacker_id join submissions s on s.hacker_id = hk.hacker_id)) where rn =1;
